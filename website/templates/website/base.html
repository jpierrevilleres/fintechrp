{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    {# Google Consent Mode v2 - Must load before AdSense #}
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        
        // Default consent to denied for GDPR compliance
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied'
        });
    </script>
    
    {# Google AdSense #}
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1944859451923609"
     crossorigin="anonymous"></script>
    
    {# Analytics removed: reverted to previous state (no gtag) #}

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>{% block title %}FinTechRP - Finance, Technology & Real Estate Insights{% endblock %}</title>
    
    {# SEO Meta Tags #}
    <meta name="description" content="{% block meta_description %}{{ META_DESCRIPTION }}{% endblock %}">
    <meta name="author" content="{% block meta_author %}FinTechRP{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}finance, technology, real estate, fintech, investment{% endblock %}">
    
    {# Open Graph / Facebook #}
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:title" content="{% block og_title %}{{ self.title }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.meta_description }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ STATIC_URL }}img/default-social.jpg{% endblock %}">
    
    {# Twitter #}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ self.og_title }}">
    <meta name="twitter:description" content="{{ self.og_description }}">
    <meta name="twitter:image" content="{{ self.og_image }}">
    
    {# Favicon was added previously; reverted to previous state - no explicit SVG favicon here #}
    
    {# CSS #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Google Fonts: keep default stack; Roboto addition removed to restore prior font setup -->
    
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link href="{% static 'css/components.css' %}" rel="stylesheet">
    
    
    {% block extra_css %}{% endblock %}
    <style>
    /* Minimal inline fallbacks so pages look acceptable even if external CSS is blocked */
    body { font-family: Inter, system-ui, -apple-system, 'Segoe UI', Helvetica, Arial, sans-serif; color: #2d3748; margin:0; }
        .navbar { padding: 1rem 0; border-bottom: 1px solid #e9ecef; }
        .navbar-brand { font-weight:700; color: #0056b3; }
        .nav-link { color: #495057; text-decoration: none; padding: 0.5rem; display:inline-block }
        .container { max-width: 1100px; margin: 0 auto; padding: 0 1rem; }
        h1, h2, h3 { font-weight:700; }
        .card { background: #fff; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
        .btn { display:inline-block; padding: 0.5rem 1rem; border-radius:6px; background:#0d6efd; color:#fff; text-decoration:none; border:none }
        .form-control { padding:0.45rem 0.6rem; border:1px solid #ced4da; border-radius:6px; width:100%; box-sizing:border-box }

        /* Footer specific styles moved to static/css/style.css */
    </style>
    
    {# Google Analytics or similar #}
    {% if not debug %}
    <!-- Add your analytics code here -->
    {% endif %}
</head>
<body>
    <header class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
        <div class="container">
            <a class="navbar-brand" href="{% url 'home' %}">
                <strong>FinTechRP</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'article_list' %}">Articles</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="categoriesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Categories
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="categoriesDropdown">
                            <li>
                                <a class="dropdown-item d-flex align-items-center" href="{% url 'article_list' %}">
                                    <i class="bi bi-list me-2"></i> All
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            {% for code, name in ARTICLE_CATEGORIES %}
                            <li>
                                <a class="dropdown-item d-flex align-items-center" href="{% url 'article_list_by_category' category_slug=code %}">
                                    {% if code == 'finance' %}
                                        <i class="bi bi-currency-dollar me-2 text-success"></i>
                                    {% elif code == 'technology' %}
                                        <i class="bi bi-laptop me-2 text-primary"></i>
                                    {% elif code == 'real_estate' or code == 'real-estate' %}
                                        <i class="bi bi-building me-2 text-danger"></i>
                                    {% elif code == 'trade' %}
                                        <i class="bi bi-globe me-2 text-warning"></i>                                       
                                    {% else %}
                                        <i class="bi bi-tags me-2"></i>
                                    {% endif %}
                                    {{ name }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'about' %}">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'contact' %}">Contact</a>
                    </li>
                </ul>
                
                <form class="d-flex" method="get" action="{% url 'article_list' %}">
                    <input class="form-control me-2" type="search" placeholder="Search articles..." name="q">
                    <button class="btn btn-outline-primary" type="submit">Search</button>
                </form>
                
                <ul class="navbar-nav ms-3">
                    <li class="nav-item">
                        <a class="nav-link social-link" href="https://linkedin.com/company/fintechrp" target="_blank" rel="noopener noreferrer" title="Follow us on LinkedIn" aria-label="LinkedIn">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M19 0H5C3.895 0 3 .895 3 2v20c0 1.105.895 2 2 2h14c1.105 0 2-.895 2-2V2c0-1.105-.895-2-2-2zM8.339 20H5.667V9h2.672v11zM7 7.75c-.828 0-1.5-.672-1.5-1.5S6.172 4.75 7 4.75s1.5.672 1.5 1.5S7.828 7.75 7 7.75zM20 20h-2.667v-5.5c0-1.31-.467-2.2-1.639-2.2-.895 0-1.423.605-1.657 1.193-.085.213-.106.508-.106.804V20H10.5V9h2.56v1.52c.339-.52.951-1.267 2.309-1.267 1.68 0 2.931 1.102 2.931 3.469V20z" fill="currentColor"/></svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social-link" href="https://twitter.com/fintechrp" target="_blank" rel="noopener noreferrer" title="Follow us on Twitter" aria-label="Twitter">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53A4.48 4.48 0 0 0 22.43 1s-2.11.99-3.35 1.36A4.48 4.48 0 0 0 12 6.48v.56A12.94 12.94 0 0 1 3 2s-4 9 5 13a13 13 0 0 1-7 2c9 5.5 20 0 20-11.5v-.5A7.72 7.72 0 0 0 23 3z" fill="currentColor"/></svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social-link" href="https://facebook.com/fintechrp" target="_blank" rel="noopener noreferrer" title="Follow us on Facebook" aria-label="Facebook">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2.2v-2.9h2.2V9.1c0-2.2 1.3-3.5 3.3-3.5.96 0 1.96.17 1.96.17v2.15h-1.1c-1.1 0-1.44.68-1.44 1.38v1.66h2.45l-.39 2.9h-2.06V22A10 10 0 0 0 22 12z" fill="currentColor"/></svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social-link" href="https://youtube.com/@fintechrp" target="_blank" rel="noopener noreferrer" title="Follow us on YouTube" aria-label="YouTube">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M5 3.87v16.26L19 12 5 3.87z" fill="currentColor"/></svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social-link" href="https://reddit.com/r/fintechrp" target="_blank" rel="noopener noreferrer" title="Follow us on Reddit" aria-label="Reddit">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><circle cx="12" cy="12" r="10" fill="currentColor" /><circle cx="9" cy="11" r="1.2" fill="#fff" /><circle cx="15" cy="11" r="1.2" fill="#fff" /><path d="M8 15c1.2 1 3.6 1 5 0" stroke="#fff" stroke-width="1.2" fill="none" stroke-linecap="round" /><circle cx="18.2" cy="7.3" r="1" fill="#fff" /></svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social-link" href="https://www.tiktok.com/@fintechrp" target="_blank" rel="noopener noreferrer" title="Follow us on TikTok" aria-label="TikTok">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M16 6.5v6.3a3.5 3.5 0 1 1-1.5-2.9V5.2h2.4z" fill="currentColor" /></svg>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <main class="container py-4">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}
        
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-light mt-5">
        <div class="container py-5">
            <div class="row g-4 align-items-start">
                <div class="col-md-4">
                    <h5>About FinTechRP</h5>
                    <p class="mb-2">Expert insights on Finance, Technology, and Real Estate markets.</p>
                    <div class="social-icons mt-3">
                        <!-- LinkedIn -->
                        <a href="https://linkedin.com/company/fintechrp" class="text-decoration-none" target="_blank" rel="noopener noreferrer" title="Follow us on LinkedIn" aria-label="LinkedIn">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M19 0H5C3.895 0 3 .895 3 2v20c0 1.105.895 2 2 2h14c1.105 0 2-.895 2-2V2c0-1.105-.895-2-2-2zM8.339 20H5.667V9h2.672v11zM7 7.75c-.828 0-1.5-.672-1.5-1.5S6.172 4.75 7 4.75s1.5.672 1.5 1.5S7.828 7.75 7 7.75zM20 20h-2.667v-5.5c0-1.31-.467-2.2-1.639-2.2-.895 0-1.423.605-1.657 1.193-.085.213-.106.508-.106.804V20H10.5V9h2.56v1.52c.339-.52.951-1.267 2.309-1.267 1.68 0 2.931 1.102 2.931 3.469V20z" fill="currentColor"/>
                            </svg>
                        </a>
                        <!-- Twitter -->
                        <a href="https://twitter.com/fintechrp" class="text-decoration-none" target="_blank" rel="noopener noreferrer" title="Follow us on Twitter" aria-label="Twitter">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53A4.48 4.48 0 0 0 22.43 1s-2.11.99-3.35 1.36A4.48 4.48 0 0 0 12 6.48v.56A12.94 12.94 0 0 1 3 2s-4 9 5 13a13 13 0 0 1-7 2c9 5.5 20 0 20-11.5v-.5A7.72 7.72 0 0 0 23 3z" fill="currentColor"/>
                            </svg>
                        </a>
                        <!-- Facebook -->
                        <a href="https://facebook.com/fintechrp" class="text-decoration-none" target="_blank" rel="noopener noreferrer" title="Follow us on Facebook" aria-label="Facebook">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2.2v-2.9h2.2V9.1c0-2.2 1.3-3.5 3.3-3.5.96 0 1.96.17 1.96.17v2.15h-1.1c-1.1 0-1.44.68-1.44 1.38v1.66h2.45l-.39 2.9h-2.06V22A10 10 0 0 0 22 12z" fill="currentColor"/>
                            </svg>
                        </a>
                        <!-- YouTube (play glyph) -->
                        <a href="https://youtube.com/@fintechrp" class="text-decoration-none" target="_blank" rel="noopener noreferrer" title="Follow us on YouTube" aria-label="YouTube">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M5 3.87v16.26L19 12 5 3.87z" fill="currentColor"/>
                            </svg>
                        </a>
                        <!-- Reddit (simple mark) -->
                        <a href="https://reddit.com/r/fintechrp" class="text-decoration-none" target="_blank" rel="noopener noreferrer" title="Follow us on Reddit" aria-label="Reddit">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <circle cx="12" cy="12" r="10" fill="currentColor" />
                                <circle cx="9" cy="11" r="1.2" fill="#fff" />
                                <circle cx="15" cy="11" r="1.2" fill="#fff" />
                                <path d="M8 15c1.2 1 3.6 1 5 0" stroke="#fff" stroke-width="1.2" fill="none" stroke-linecap="round" />
                                <circle cx="18.2" cy="7.3" r="1" fill="#fff" />
                            </svg>
                        </a>
                        <!-- TikTok (simplified note) -->
                        <a href="https://www.tiktok.com/@fintechrp" class="text-decoration-none" target="_blank" rel="noopener noreferrer" title="Follow us on TikTok" aria-label="TikTok">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M16 6.5v6.3a3.5 3.5 0 1 1-1.5-2.9V5.2h2.4z" fill="currentColor" />
                            </svg>
                        </a>
                    </div>
                </div>

                <div class="col-md-4">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled mb-0">
                        <li class="mb-1"><a href="{% url 'home' %}">Home</a></li>
                        <li class="mb-1"><a href="{% url 'article_list' %}">Articles</a></li>
                        <li class="mb-1"><a href="{% url 'about' %}">About</a></li>
                        <li class="mb-1"><a href="{% url 'contact' %}">Contact</a></li>
                    </ul>
                </div>

                <div class="col-md-4">
                    <h5>Newsletter</h5>
                    <p class="small text-muted">Get the latest articles and insights delivered to your inbox.</p>
                    <form action="{% url 'newsletter_signup' %}" method="post" class="newsletter-form" id="newsletterForm">
                        {% csrf_token %}
                        <div class="input-group mb-3">
                            <input type="email" name="email" class="form-control" placeholder="Your email" required>
                            <button class="btn btn-primary" type="submit">Subscribe</button>
                        </div>
                    </form>
                </div>
            </div>

            <hr class="my-4">

            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="mb-0">&copy; {% now "Y" %} FinTechRP. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <a href="{% url 'privacy_policy' %}" class="text-decoration-none me-3">Privacy Policy</a>
                    <a href="{% url 'terms_policy' %}" class="text-decoration-none me-3">Terms of Service</a>
                    <a href="{% url 'cookie_policy' %}" class="text-decoration-none">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>

    {# JavaScript #}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script src="{% static 'js/main.js' %}"></script>
    
    {# Cookie Consent Banner #}
    <div id="cookieConsent" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; background: #2d3748; color: white; padding: 20px; z-index: 9999; box-shadow: 0 -2px 10px rgba(0,0,0,0.1);">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-9">
                    <p class="mb-2 mb-md-0"><strong>Cookie Consent</strong><br>
                    We use cookies and similar technologies to personalize content and ads, provide social media features, and analyze our traffic. This includes using Google AdSense for advertising. By clicking "Accept All", you consent to our use of cookies. You can manage your preferences in our <a href="{% url 'cookie_policy' %}" style="color: #90cdf4; text-decoration: underline;">Cookie Policy</a>.</p>
                </div>
                <div class="col-md-3 text-md-end">
                    <button onclick="acceptCookies()" class="btn btn-primary me-2">Accept All</button>
                    <button onclick="rejectCookies()" class="btn btn-outline-light">Reject</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Check if user has already consented
        if (!localStorage.getItem('cookieConsent')) {
            document.getElementById('cookieConsent').style.display = 'block';
        }
        
        function acceptCookies() {
            localStorage.setItem('cookieConsent', 'accepted');
            document.getElementById('cookieConsent').style.display = 'none';
            // Enable analytics and ads
            if (typeof gtag !== 'undefined') {
                gtag('consent', 'update', {
                    'ad_storage': 'granted',
                    'analytics_storage': 'granted'
                });
            }
        }
        
        function rejectCookies() {
            localStorage.setItem('cookieConsent', 'rejected');
            document.getElementById('cookieConsent').style.display = 'none';
            // Disable analytics and ads
            if (typeof gtag !== 'undefined') {
                gtag('consent', 'update', {
                    'ad_storage': 'denied',
                    'analytics_storage': 'denied'
                });
            }
        }
    </script>
    
    {% block extra_js %}{% endblock %}

    {# Structured Data #}
    {% block structured_data %}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "FinTechRP",
        "url": "{{ request.scheme }}://{{ request.get_host }}",
        "logo": "{{ request.scheme }}://{{ request.get_host }}{% static 'img/logo.png' %}",
        "sameAs": [
            "https://twitter.com/fintechrp",
            "https://linkedin.com/company/fintechrp"
        ]
    }
    </script>
    {% endblock %}
</body>
</html>
